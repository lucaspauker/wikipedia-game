import wikipedia_game
from bottle import get, post, request, template, run
import os

@get('/')
def page():
    '''Main (and only) page, I'm testing this whole template thing '''

    info = {'title': 'Wikipedia Game',
    'content': 'Find the shortest path between any two web pages!'
    }

    return template('simple.tpl', info)

@post('/')
def form_post():
    start = request.forms.get('start')
    end = request.forms.get('end')
    start = 'https://en.wikipedia.org/' + start
    end = 'https://en.wikipedia.org/' + end
    results = wikipedia_game.run_bfs(end, start)
    # Bottle doesn't have the fancy state change stuff React does - or maybe it shouldn't matter and we can add it in another iteration?
    result = {'results': results}
    return template('result.tpl', result)


if __name__ == '__main__':
    port = int(os.environ.get('PORT', 8080)) #change this for Heroku
    run(host='0.0.0.0', port=port, debug=True, reloader=True)